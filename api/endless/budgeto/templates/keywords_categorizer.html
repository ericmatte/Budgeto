{% extends "main-layout.html" %}

{% block head %}
<link href="https://cdnjs.cloudflare.com/ajax/libs/dragula/3.7.2/dragula.min.js" rel="stylesheet">

<style>
    .child-icon {
        color: #999999;
        text-shadow: 1px 1px 1px #ccc;
        font-size: 0.9em;
    }
</style>
{% endblock %}

{% block body %}

<br>

{% macro create_categories_panels(cat_dict) %}
{% for key, value in cat_dict recursive %}
<div class="{% if value.category.parent_id is none %}col-lg-4{% endif %}">
    <div class="panel panel-default">
        <div class="panel-heading">
            <a data-toggle="collapse" href="#{{ value.category.category_id }}">
                {% if value.category.icon %}<i class="fa {{ value.category.icon }}" aria-hidden="true"></i>{% endif %}
                <span name="name">{{ value.category.name }}</span> (#<span name="id">{{ value.category.category_id }}</span>)
                {% if value.children | length > 0 %}
                :
                {% for child_key, child_value in value.children.items() %}
                {% if child_value.category.icon %}<i class="child-icon fa {{ child_value.category.icon }}" aria-hidden="true"></i>{% endif %}
                {% endfor %}
                {% endif %}
            </a>
        </div>
        <div id="{{ value.category.category_id }}" class="panel-collapse collapse {% if value.category.parent_id is none %}in{% endif %}">
            <div class="panel-body">
                Keyword, Keyword, Keyword
            </div>
            {% if value.children | length > 0 %}
            <div class="panel-footer">
                {{ loop(value.children.items()) }}
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endfor %}
{% endmacro %}

<div class="row">
    {{ create_categories_panels(categories.items()) }}
</div>

{% endblock %}

{% block js_libs %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/dragula/3.7.2/dragula.min.js"></script>
{% endblock %}