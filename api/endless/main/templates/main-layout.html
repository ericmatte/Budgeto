<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#" lang="en">
<head>
    <!-- Facebook Open Graph -->
    <meta property="og:title" content="{{ title or 'Endless' }}"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="{{ request.url + '/' }}"/>
    <meta property="og:image" content="http://endlessapi.ddns.net:8080/static/endless/img/favicon_xl.png"/>
    <meta property="og:image:width" content="512" />
    <meta property="og:image:height" content="512" />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:site_name" content="Endless Budgeto"/>
    <meta property="og:description" content="A free budget app"/>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="apple-touch-icon" sizes="76x76" href="{{ url_for('static', filename='endless/img/favicon.png') }}" />
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='endless/img/favicon.png') }}" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="google-signin-client_id" content="{{ config['CLIENT_ID'] }}">

    <title>{{ title or 'Endless' }}</title>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
    <!--<link href="//cdn.datatables.net/1.10.13/css/jquery.dataTables.min.css" rel="stylesheet">-->

    <link href="{{ url_for('static', filename='perfect-scrollbar/perfect-scrollbar.css') }}" rel="stylesheet"/>
    <link href="{{ url_for('static', filename='materialize/css/materialize.min.css') }}" type="text/css" rel="stylesheet" media="screen,projection"/>
    <link href="{{ url_for('static', filename='endless/css/style.css') }}" type="text/css" rel="stylesheet" media="screen,projection"/>

    {% block head %}{% endblock %}

</head>

<body>
    {% block full_body %}

    <ul id="side-bar" class="side-nav fixed">
        <li><div class="userView">
            <div class="background">
                <img src="{{ url_for('static', filename='endless/img/cover.jpg') }}">
            </div>
            <img class="circle" src="{{ g.user.picture or '//ssl.gstatic.com/accounts/ui/avatar_2x.png' }}">
            <span class="white-text name">{{ g.user.full_name }}</span>
            <span class="white-text email">{{ g.user.email }}</span>
        </div></li>


        {% macro side_item(title, icon, url) %}
        <li{% if request.path == url %} class="active"{% endif %}>
            <a class="waves-effect waves-teal" href="{{ url }}"><i class="material-icons">{{ icon }}</i>{{ title }}</a>
        </li>
        {% endmacro %}

        {{ side_item('Transactions', 'trending_up', url_for("budgeto.transactions")) }}
        {{ side_item('Budget', 'account_balance_wallet', url_for("budgeto.budget")) }}
        
        {% if 'admin' in g.user.roles %}
        <li><div class="divider"></div></li>
        <li><a class="subheader">Admin Tools</a></li>
        {{ side_item('Keywords Categorizer', 'storage', url_for("budgeto.keywords_categorizer")) }}
        {{ side_item('Keywords Creator', 'loyalty', url_for("budgeto.keywords_creator")) }}
        <li><a class="waves-effect waves-teal" href="http://materializecss.com/getting-started.html" target="_blank"><i class="material-icons">view_compact</i>Materialize</a></li>
        {% endif %}
        
        <li><div class="divider"></div></li>
        <li><a class="subheader">Your account</a></li>
        <li><a class="waves-effect waves-teal" onclick="Materialize.toast('Settings is not available yet.', 4000)"><i class="material-icons">settings</i>Settings</a></li>
        <li><a class="waves-effect waves-teal" onclick="signOut();"><i class="material-icons">exit_to_app</i>Signout</a></li>
        <li><a class="waves-effect waves-teal" href="mailto:{{ config['ADMIN_EMAIL'] }}?Subject=Need%20help%20with%20{{ (title or 'Endless') | e }}"><i class="material-icons">help</i>Help & feedback</a></li>
    </ul>


    <header>
        <nav class="teal darken-1" role="navigation">
            <div class="nav-wrapper container">
                <a id="logo-container" href="#" class="brand-logo">Budgeto</a>
                <ul class="right hide-on-med-and-down">
                    {% block options %}{% endblock %}
                    <li><a onclick="signOut();">Signout</a></li>
                </ul>
                <a href="#" data-activates="side-bar" class="button-collapse"><i class="material-icons">menu</i></a>
            </div>
        </nav>
    </header>
    <main class="">
		<div class="container">
		<div class="row">
		<div class="col s12 m12">
        {% block body %}
        <div class="section no-pad-bot">
            <div class="container">
                <br><br>
                <h1 class="header center orange-text">Starter Template</h1>
                <div class="row center">
                    <h5 class="header col s12 light">To be replaced by a web page content</h5>
                </div>
                <div class="row center">
                    <a href="http://materializecss.com/getting-started.html" target="_blank" id="download-button" class="btn-large waves-effect waves-light orange">Get Started</a>
                </div>
                <br><br>
            </div>
        </div>
        {% endblock %}
		</div>
		</div>
		</div>
    </main>

    {% block modals %}{% endblock %}

    {% endblock %}

    <script src="{{ url_for('static', filename='materialize/js/jquery-3.1.1.min.js') }}"></script>
    <!--<script src="//cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>-->
    <script src="{{ url_for('static', filename='materialize/js/materialize.js') }}"></script>
    <script src="{{ url_for('static', filename='perfect-scrollbar/perfect-scrollbar.jquery.min.js') }}"></script>

    <script src="https://apis.google.com/js/platform.js?onload=onLoad" async defer></script>
    {% block google_signin %}
    <script type="application/javascript">
        function onLoad() {
            gapi.load('auth2', function() {
                gapi.auth2.init();
            });
        }

        function signOut() {
            var auth2 = gapi.auth2.getAuthInstance();
            auth2.signOut().then(function () {
                $.ajax({
                    url: "{{ url_for('main_services.logout') }}",
                    method: 'post'
                }).done(function() {
                    console.log('User signed out.');
                    location.reload()
                });
            });
        }
    </script>
    {% endblock %}

    <script src="{{ url_for('static', filename='endless/js/init.js') }}"></script>
    {% block js %}{% endblock %}
</body>
</html>